# Проект Mesto фронтенд + бэкенд

[![Tests 13 sprint](https://github.com/DenisIlyushin/express-mesto-gha/actions/workflows/tests-13-sprint.yml/badge.svg?branch=main)](https://github.com/DenisIlyushin/express-mesto-gha/actions/workflows/tests-13-sprint.yml)
[![Tests 14 sprint](https://github.com/DenisIlyushin/express-mesto-gha/actions/workflows/tests-14-sprint.yml/badge.svg)](https://github.com/DenisIlyushin/express-mesto-gha/actions/workflows/tests-14-sprint.yml)

[Ссылка на репозиторий для проверки actions](https://github.com/DenisIlyushin/express-mesto-gha/actions)

---
## О проекте

Учебный проект, курс WEB-разработчик, спринт 14.
[Яндекс.Практикум](https://practicum.yandex.ru/).

Проект посвящен вымышленному сервису **Mesto** - интерактивной странице, куда
можно добавлять фотографии, удалять их и ставить лайки.

Данная реализация представляет собой бекенд для [сайта проекта
место](https://denisilyushin.github.io/react-mesto-auth/). На данный момент фронт
сайта не сопряжен с разрабатываемым бекендом.

---
### Технологии

- NodeJS
- Express
- mongoDB
- Mongoose

### Дополнительные модули

- [http-status-codes](https://www.npmjs.com/package/http-status-codes) -
  константы, перечисляющие коды состояния HTTP. Основан на Java Apache Http Status API.
- [celebrate](https://www.npmjs.com/package/celebrate) - middleware для валидации вводных данных.
- [validator](https://www.npmjs.com/package/validator) - библиотека для проверки строчных данных.
- [jsonwebtoken](https://www.npmjs.com/package/jsonwebtoken) - позволяет использовать [JWT](https://datatracker.ietf.org/doc/html/rfc7519).
- [bcryptjs](https://www.npmjs.com/package/bcryptjs) - оптимизированная для JS библиотека bcrypt (шифрование).

### Директории

`/routes` — папка с файлами роутера

`/controllers` — папка с файлами контроллеров пользователя и карточки

`/models` — папка с файлами описания схем пользователя и карточки

`/middleware` — папка c middleware обработчиками

`/errors` — папка с ошибками и функциями их обработки

`/utils` — папка с универсальными функциями

## URI
| Роут                   | Запрос    | Действие                                                                                                                                             | Ошибки                                                                                                                                                                                                                |
|------------------------| --------- |------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `/signup`              | `POST` | `POST`-запрос создаёт пользователя с переданными в теле запроса `name`, `about`, `avatar`, `email`, `password`                                       | `400` — Переданы некорректные данные при создании пользователя. `409` — Пользователь уже существует. `500` — Ошибка по умолчанию.                                                                                     |
| `/signin`              | `POST`   | `POST`-запрос создаёт JWT-токен для пользователя по переданным в теле запроса `email`, `password`                                              | `400` — Переданы некорректные данные при создании пользователя. `500` — Ошибка по умолчанию.                                                                                                                          |
| `/users`               | `GET POST` | `GET`-запрос возвращает всех пользователей из базы данных; `POST`-запрос создаёт пользователя с переданными в теле запроса `name`, `about`, `avatar` | `400` — Переданы некорректные данные при создании пользователя. `401` — Ошибка авторизации. `500` — Ошибка по умолчанию.                                                                                              |
| `/users/:userId`       | `GET`     | `GET`-запрос возвращает пользователя по переданному `_id`.                                                                                           | `404` — Пользователь по указанному `_id` не найден. `401` — Ошибка авторизации. `500` — Ошибка по умолчанию.                                                                                                          |
| `/users/me`            | `PATCH`   | `PATCH`-запрос обновляет информацию о текущем пользователе.                                                                                          | `400` — Переданы некорректные данные при обновлении профиля. `401` — Ошибка авторизации. `403` — Попытка редактирования чужого профиля. `404` — Пользователь с указанным `_id` не найден. `500` — Ошибка по умолчанию. |
| `/users/me/avatar`     | `PATCH`   | `PATCH`-запрос обновляет аватар пользователя.                                                                                                        | `400` — Переданы некорректные данные при обновлении аватара. `401` — Ошибка авторизации. `403` — Попытка редактирования чужого профиля. `404` — Пользователь с указанным `_id` не найден. `500` — Ошибка по умолчанию. |
| `/cards`               | `GET POST` | `GET`-запрос возвращает все карточки из базы данных. `POST`-запрос создает новую карточку по переданным параметрам.                                  | `400` — Переданы некорректные данные при создании карточки. `401` — Ошибка авторизации. `500` — Ошибка по умолчанию.                                                                                                  |
| `/cards/:cardId`       | `DELETE`  | `DELETE`-запрос удаляет карточку по `_id`.                                                                                                           | `401` — Ошибка авторизации. `404` — Карточка с указанным `_id` не найдена.                                                                                                                                            |
| `/cards/:cardId/likes` | `PUT DELETE` | `PUT`-запрос добавляет лайк карточке. `DELETE`-запрос удаляет лайк с карточки.                                                                       | `400` — Переданы некорректные данные для постановки/снятии лайка. `401` — Ошибка авторизации. `404` — Передан несуществующий `_id` карточки. `500` — Ошибка по умолчанию.                                             |

## Запуск проекта

После клонирования репозитория требуется установить зависимости:

```bash
npm install
```

`npm run start` — запускает сервер, 
`npm run dev` — запускает сервер с hot-reload (dev-mode)

### Шаблон наполнения .env
Файл `.env` следует разместить в директории `./backend`.
Пример наполнения с комментариями приведет в файле `./.env.example`

ВНИМАНИЕ! При форматировании файла убрать все, что написано после `#` 

---
### Автор проекта

Ден Илюшин ([DenisIlyushin](https://github.com/DenisIlyushin/))
